В данном репозитории проведена работа над решением задачи замены фона для карточек товаров и создания описания для них.
Мое решение использует модель BiRefNet для сегментации, проведя исследование, было выявлено,
что данная модель показывает лучшее качество, при высокой скорости обработки.

Я написал генератор фона, для того, что бы придать ему объем я сделал горизонтальную линию градиента,
который настраивается в зависимости от самых нижних пикселей маски и создает эффект плоскости.
Такой подход отлично подходит к предметам, которые находятся на плоскости, но в некоторых случаях не совсем корректно.
Помимо этого было подобрано несколько вариаций фона в светлых цветах. 

Сегментация и генерация фона для каждого изображения датасета заняла около 8 минут (gpu Tesla T4). 

Для описания изображения я использовал VLM OpenGVLab/InternVL2-2B, эта модель при относительно небольших для LLM размерах, 
показывает отличную точность, ее можно развернуть локально, генерация описания занимает около 10 секунд (gpu Tesla T4), 
при необходимости можно использовать более крупные варианты, в случае если модель не помещается на одной gpu,
ее легко можно разделить на несколько gpu.
 
Так как данная модель плохо работает с русским языком, было решено использовать api GigaChat,
он обрабатывает описание сгенерированное InternVL2 и на его основе генерирует название товара и его описание в формате json.
Как можно улучшить решения?
- генерировать помимо описание, информацию о расположении объекта и на ее основе генерировать фон;
- квантовать InternVL2 для оптимизации вычислений; - заменить api GigaChat на локальную модельку;
- заняться finetuning BiRefNet для лучшей сегментации текста и сложных объектов.

Работа над такими улучшениями позволит мне получить класный опыт, но на данный момент мне не хватает опыта и ресурсов.

Задачу генерации описания очевидно можно решить через api к таким моделям как gemini или chatGPT,
точность и скорость будут высокими, но такой решение абсолютно не интересное.

orig - предоставленный датасет
result - обработанный датасет
sirius-tink.ipynb - блокнот юпитер с инференсом